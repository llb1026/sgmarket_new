!function(){function e(){return!1}function t(e,t){var n,i=[];for(e.filterChildren(t),n=e.children.length-1;0<=n;n--)i.unshift(e.children[n]),e.children[n].remove();n=e.attributes;var o,a=e,r=!0;for(o in n)if(r)r=!1;else{var s=new CKEDITOR.htmlParser.element(e.name);s.attributes[o]=n[o],a.add(s),a=s,delete n[o]}for(n=0;n<i.length;n++)a.add(i[n])}var n,i,o,a=CKEDITOR.tools,r=["o:p","xml","script","meta","link"],s={},l=0;CKEDITOR.plugins.pastefromword={},CKEDITOR.cleanWord=function(c,d){var u=Boolean(c.match(/mso-list:\s*l\d+\s+level\d+\s+lfo\d+/));c=c.replace(/<!\[/g,"<!--[").replace(/\]>/g,"]-->");var h=CKEDITOR.htmlParser.fragment.fromHtml(c);o=new CKEDITOR.htmlParser.filter({root:function(e){e.filterChildren(o),CKEDITOR.plugins.pastefromword.lists.cleanup(n.createLists(e))},elementNames:[[/^\?xml:namespace$/,""],[/^v:shapetype/,""],[new RegExp(r.join("|")),""]],elements:{a:function(e){if(e.attributes.name){if("_GoBack"==e.attributes.name)return void delete e.name;if(e.attributes.name.match(/^OLE_LINK\d+$/))return void delete e.name}if(e.attributes.href&&e.attributes.href.match(/#.+$/)){var t=e.attributes.href.match(/#(.+)$/)[1];s[t]=e}e.attributes.name&&s[e.attributes.name]&&(e=s[e.attributes.name],e.attributes.href=e.attributes.href.replace(/.*#(.*)$/,"#$1"))},div:function(e){i.createStyleStack(e,o,d)},img:function(e){if(e.parent){var t=e.parent.attributes;(t=t.style||t.STYLE)&&t.match(/mso\-list:\s?Ignore/)&&(e.attributes["cke-ignored"]=!0)}i.mapStyles(e,{width:function(t){i.setStyle(e,"width",t+"px")},height:function(t){i.setStyle(e,"height",t+"px")}}),e.attributes.src&&e.attributes.src.match(/^file:\/\//)&&e.attributes.alt&&e.attributes.alt.match(/^https?:\/\//)&&(e.attributes.src=e.attributes.alt)},p:function(e){if(e.filterChildren(o),e.attributes.style&&e.attributes.style.match(/display:\s*none/i))return!1;if(n.thisIsAListItem(e))n.convertToFakeListItem(e);else{var t=e.getAscendant(function(e){return"ul"==e.name||"ol"==e.name}),r=a.parseCssText(e.attributes.style);t&&!t.attributes["cke-list-level"]&&r["mso-list"]&&r["mso-list"].match(/level/)&&(t.attributes["cke-list-level"]=r["mso-list"].match(/level(\d+)/)[1])}i.createStyleStack(e,o,d)},pre:function(e){n.thisIsAListItem(e)&&n.convertToFakeListItem(e),i.createStyleStack(e,o,d)},h1:function(e){n.thisIsAListItem(e)&&n.convertToFakeListItem(e),i.createStyleStack(e,o,d)},font:function(e){return e.getHtml().match(/^\s*$/)?(new CKEDITOR.htmlParser.text(" ").insertAfter(e),!1):(d&&!0===d.config.pasteFromWordRemoveFontStyles&&e.attributes.size&&delete e.attributes.size,void t(e,o))},ul:function(e){if(u)return"li"==e.parent.name&&0===a.indexOf(e.parent.children,e)&&i.setStyle(e.parent,"list-style-type","none"),n.dissolveList(e),!1},li:function(e){u&&(e.attributes.style=i.normalizedStyles(e,d),i.pushStylesLower(e))},ol:function(e){if(u)return"li"==e.parent.name&&0===a.indexOf(e.parent.children,e)&&i.setStyle(e.parent,"list-style-type","none"),n.dissolveList(e),!1},span:function(e){if(e.filterChildren(o),e.attributes.style=i.normalizedStyles(e,d),!e.attributes.style||e.attributes.style.match(/^mso\-bookmark:OLE_LINK\d+$/)||e.getHtml().match(/^(\s|&nbsp;)+$/)){for(var t=e.children.length-1;0<=t;t--)e.children[t].insertAfter(e);return!1}i.createStyleStack(e,o,d)},table:function(e){e._tdBorders={},e.filterChildren(o);var t,n,a=0;for(n in e._tdBorders)e._tdBorders[n]>a&&(a=e._tdBorders[n],t=n);i.setStyle(e,"border",t)},td:function(e){var t=e.getAscendant("table"),n=t._tdBorders,o=["border","border-top","border-right","border-bottom","border-left"],t=a.parseCssText(t.attributes.style),r=t.background||t.BACKGROUND;r&&i.setStyle(e,"background",r,!0),(t=t["background-color"]||t["BACKGROUND-COLOR"])&&i.setStyle(e,"background-color",t,!0);var s,t=a.parseCssText(e.attributes.style);for(s in t)r=t[s],delete t[s],t[s.toLowerCase()]=r;for(s=0;s<o.length;s++)t[o[s]]&&(r=t[o[s]],n[r]=n[r]?n[r]+1:1);i.pushStylesLower(e,{background:!0})},"v:imagedata":e,"v:shape":function(e){var t=!1;if(e.parent.getFirst(function(n){"img"==n.name&&n.attributes&&n.attributes["v:shapes"]==e.attributes.id&&(t=!0)}),t)return!1;var n="";e.forEach(function(e){e.attributes&&e.attributes.src&&(n=e.attributes.src)},CKEDITOR.NODE_ELEMENT,!0),e.filterChildren(o),e.name="img",e.attributes.src=e.attributes.src||n,delete e.attributes.type},style:function(){return!1}},attributes:{style:function(e,t){return i.normalizedStyles(t,d)||!1},"class":function(e){return e=e.replace(/msonormal|msolistparagraph\w*/gi,""),""!==e&&e},cellspacing:e,cellpadding:e,border:e,valign:e,"v:shapes":e,"o:spid":e},comment:function(e){return e.match(/\[if.* supportFields.*\]/)&&l++,"[endif]"==e&&(l=0<l?l-1:0),!1},text:function(e){return l?"":e.replace(/&nbsp;/g," ")}});var m=new CKEDITOR.htmlParser.basicWriter;return o.applyTo(h),h.writeHtml(m),m.getHtml()},CKEDITOR.plugins.pastefromword.styles={setStyle:function(e,t,n,i){var o=a.parseCssText(e.attributes.style);i&&o[t]||(""===n?delete o[t]:o[t]=n,e.attributes.style=CKEDITOR.tools.writeCssText(o))},mapStyles:function(e,t){for(var n in t)e.attributes[n]&&("function"==typeof t[n]?t[n](e.attributes[n]):i.setStyle(e,t[n],e.attributes[n]),delete e.attributes[n])},normalizedStyles:function(e,t){var i="background-color:transparent border-image:none color:windowtext direction:ltr mso- text-indent visibility:visible div:border:none".split(" "),o="font-family font font-size color background-color line-height text-decoration".split(" "),r=function(){for(var e=[],t=0;t<arguments.length;t++)arguments[t]&&e.push(arguments[t]);return-1!==a.indexOf(i,e.join(":"))},s=t&&!0===t.config.pasteFromWordRemoveFontStyles,l=a.parseCssText(e.attributes.style);"cke:li"==e.name&&l["TEXT-INDENT"]&&l.MARGIN&&(e.attributes["cke-indentation"]=n.getElementIndentation(e),l.MARGIN=l.MARGIN.replace(/(([\w\.]+ ){3,3})[\d\.]+(\w+$)/,"$10$3"));for(var c=a.objectKeys(l),d=0;d<c.length;d++){var u=c[d].toLowerCase(),h=l[c[d]],m=CKEDITOR.tools.indexOf;(s&&-1!==m(o,u.toLowerCase())||r(null,u,h)||r(null,u.replace(/\-.*$/,"-"))||r(null,u)||r(e.name,u,h)||r(e.name,u.replace(/\-.*$/,"-"))||r(e.name,u)||r(h))&&delete l[c[d]]}return CKEDITOR.tools.writeCssText(l)},createStyleStack:function(e,t,n){var o=[];for(e.filterChildren(t),t=e.children.length-1;0<=t;t--)o.unshift(e.children[t]),e.children[t].remove();i.sortStyles(e),t=a.parseCssText(i.normalizedStyles(e,n)),n=e;var r,s="span"===e.name;for(r in t)if(!r.match(/margin|text\-align|width|border|padding/i))if(s)s=!1;else{var l=new CKEDITOR.htmlParser.element("span");l.attributes.style=r+":"+t[r],n.add(l),n=l,delete t[r]}for("{}"!==JSON.stringify(t)?e.attributes.style=CKEDITOR.tools.writeCssText(t):delete e.attributes.style,t=0;t<o.length;t++)n.add(o[t])},sortStyles:function(e){for(var t=["border","border-bottom","font-size","background"],n=a.parseCssText(e.attributes.style),i=a.objectKeys(n),o=[],r=[],s=0;s<i.length;s++)-1!==a.indexOf(t,i[s].toLowerCase())?o.push(i[s]):r.push(i[s]);for(o.sort(function(e,n){var i=a.indexOf(t,e.toLowerCase()),o=a.indexOf(t,n.toLowerCase());return i-o}),i=[].concat(o,r),o={},s=0;s<i.length;s++)o[i[s]]=n[i[s]];e.attributes.style=CKEDITOR.tools.writeCssText(o)},pushStylesLower:function(e,t){if(!e.attributes.style||0===e.children.length)return!1;t=t||{};var n,o={"list-style-type":!0,width:!0,border:!0,"border-":!0},r=a.parseCssText(e.attributes.style);for(n in r)if(!(n.toLowerCase()in o||o[n.toLowerCase().replace(/\-.*$/,"-")]||n.toLowerCase()in t)){for(var s=!1,l=0;l<e.children.length;l++){var c=e.children[l];c.type===CKEDITOR.NODE_ELEMENT&&(s=!0,i.setStyle(c,n,r[n]))}s&&delete r[n]}return e.attributes.style=CKEDITOR.tools.writeCssText(r),!0}},i=CKEDITOR.plugins.pastefromword.styles,CKEDITOR.plugins.pastefromword.lists={thisIsAListItem:function(e){return!!(e.attributes.style&&e.attributes.style.match(/mso\-list:\s?l\d/)&&"li"!==e.parent.name||e.attributes["cke-dissolved"]||e.getHtml().match(/<!\-\-\[if !supportLists]\-\->/)||e.getHtml().match(/^( )*.*?[\.\)] ( ){2,666}/))},convertToFakeListItem:function(e){if(this.getListItemInfo(e),!e.attributes["cke-dissolved"]){var t;if(e.forEach(function(e){!t&&"img"==e.name&&e.attributes["cke-ignored"]&&"*"==e.attributes.alt&&(t="\xb7",e.remove())},CKEDITOR.NODE_ELEMENT),e.forEach(function(e){t||e.value.match(/^ /)||(t=e.value)},CKEDITOR.NODE_TEXT),"undefined"==typeof t)return;e.attributes["cke-symbol"]=t.replace(/ .*$/,""),n.removeSymbolText(e)}if(e.attributes.style){var i=a.parseCssText(e.attributes.style);i["margin-left"]&&(delete i["margin-left"],e.attributes.style=CKEDITOR.tools.writeCssText(i))}e.name="cke:li"},convertToRealListItems:function(e){var t=[];return e.forEach(function(e){"cke:li"==e.name&&(e.name="li",t.push(e))},CKEDITOR.NODE_ELEMENT,!1),t},removeSymbolText:function(e){var t,n=e.attributes["cke-symbol"];e.forEach(function(i){!t&&i.value.match(n.replace(")","\\)").replace("(",""))&&(i.value=i.value.replace(n,""),i.parent.getHtml().match(/^(\s|&nbsp;)*$/)&&(t=i.parent!==e?i.parent:null))},CKEDITOR.NODE_TEXT),t&&t.remove()},setListSymbol:function(e,t,i){i=i||1;var o=a.parseCssText(e.attributes.style);if("ol"==e.name){if(e.attributes.type||o["list-style-type"])return;var r,s={"[ivx]":"lower-roman","[IVX]":"upper-roman","[a-z]":"lower-alpha","[A-Z]":"upper-alpha","\\d":"decimal"};for(r in s)if(n.getSubsectionSymbol(t).match(new RegExp(r))){o["list-style-type"]=s[r];break}e.attributes["cke-list-style-type"]=o["list-style-type"]}else s={"\xb7":"disc",o:"circle","\xa7":"square"},!o["list-style-type"]&&s[t]&&(o["list-style-type"]=s[t]);n.setListSymbol.removeRedundancies(o,i),(e.attributes.style=CKEDITOR.tools.writeCssText(o))||delete e.attributes.style},setListStart:function(e){for(var t=[],i=0,o=0;o<e.children.length;o++)t.push(e.children[o].attributes["cke-symbol"]||"");switch(t[0]||i++,e.attributes["cke-list-style-type"]){case"lower-roman":case"upper-roman":e.attributes.start=n.toArabic(n.getSubsectionSymbol(t[i]))-i;break;case"lower-alpha":case"upper-alpha":e.attributes.start=n.getSubsectionSymbol(t[i]).replace(/\W/g,"").toLowerCase().charCodeAt(0)-96-i;break;case"decimal":e.attributes.start=parseInt(n.getSubsectionSymbol(t[i]),10)-i||1}"1"==e.attributes.start&&delete e.attributes.start,delete e.attributes["cke-list-style-type"]},numbering:{toNumber:function(e,t){function n(e){e=e.toUpperCase();for(var t=1,n=1;0<e.length;n*=26)t+="ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(e.charAt(e.length-1))*n,e=e.substr(0,e.length-1);return t}function i(e){var t=[[1e3,"M"],[900,"CM"],[500,"D"],[400,"CD"],[100,"C"],[90,"XC"],[50,"L"],[40,"XL"],[10,"X"],[9,"IX"],[5,"V"],[4,"IV"],[1,"I"]];e=e.toUpperCase();for(var n=t.length,i=0,o=0;o<n;++o)for(var a=t[o],r=a[1].length;e.substr(0,r)==a[1];e=e.substr(r))i+=a[0];return i}return"decimal"==t?Number(e):"upper-roman"==t||"lower-roman"==t?i(e.toUpperCase()):"lower-alpha"==t||"upper-alpha"==t?n(e):1},getStyle:function(e){e=e.slice(0,1);var t={i:"lower-roman",v:"lower-roman",x:"lower-roman",l:"lower-roman",m:"lower-roman",I:"upper-roman",V:"upper-roman",X:"upper-roman",L:"upper-roman",M:"upper-roman"}[e];return t||(t="decimal",e.match(/[a-z]/)&&(t="lower-alpha"),e.match(/[A-Z]/)&&(t="upper-alpha")),t}},getSubsectionSymbol:function(e){return(e.match(/([\da-zA-Z]+).?$/)||["placeholder",1])[1]},setListDir:function(e){var t=0,n=0;e.forEach(function(e){"li"==e.name&&("rtl"==(e.attributes.dir||e.attributes.DIR||"").toLowerCase()?n++:t++)},CKEDITOR.ELEMENT_NODE),n>t&&(e.attributes.dir="rtl")},createList:function(e){return(e.attributes["cke-symbol"].match(/([\da-np-zA-NP-Z]).?/)||[])[1]?new CKEDITOR.htmlParser.element("ol"):new CKEDITOR.htmlParser.element("ul")},createLists:function(e){var t,i,o,a=n.convertToRealListItems(e);if(0===a.length)return[];var r=n.groupLists(a);for(e=0;e<r.length;e++){var s=r[e],l=s[0];for(o=0;o<s.length;o++)if(1==s[o].attributes["cke-list-level"]){l=s[o];break}var l=[n.createList(l)],c=l[0],d=[l[0]];for(c.insertBefore(s[0]),o=0;o<s.length;o++){for(t=s[o],i=t.attributes["cke-list-level"];i>l.length;){var u=n.createList(t),h=c.children;0<h.length?h[h.length-1].add(u):(h=new CKEDITOR.htmlParser.element("li",{style:"list-style-type:none"}),h.add(u),c.add(h)),l.push(u),d.push(u),c=u,i==l.length&&n.setListSymbol(u,t.attributes["cke-symbol"],i)}for(;i<l.length;)l.pop(),c=l[l.length-1],i==l.length&&n.setListSymbol(c,t.attributes["cke-symbol"],i);t.remove(),c.add(t)}for(l[0].children.length&&(o=l[0].children[0].attributes["cke-symbol"],!o&&1<l[0].children.length&&(o=l[0].children[1].attributes["cke-symbol"]),o&&n.setListSymbol(l[0],o)),o=0;o<d.length;o++)n.setListStart(d[o]);for(o=0;o<s.length;o++)this.determineListItemValue(s[o])}return a},cleanup:function(e){var t,n,i=["cke-list-level","cke-symbol","cke-list-id","cke-indentation","cke-dissolved"];for(t=0;t<e.length;t++)for(n=0;n<i.length;n++)delete e[t].attributes[i[n]]},determineListItemValue:function(e){if("ol"===e.parent.name){var t,n=this.calculateValue(e),i=e.attributes["cke-symbol"].match(/[a-z0-9]+/gi);i&&(i=i[i.length-1],t=e.parent.attributes["cke-list-style-type"]||this.numbering.getStyle(i),i=this.numbering.toNumber(i,t),i!==n&&(e.attributes.value=i))}},calculateValue:function(e){if(!e.parent)return 1;var t=e.parent;e=e.getIndex();var n,i,o,a=null;for(o=e;0<=o&&null===a;o--)i=t.children[o],i.attributes&&void 0!==i.attributes.value&&(n=o,a=parseInt(i.attributes.value,10));return null===a&&(a=void 0!==t.attributes.start?parseInt(t.attributes.start,10):1,n=0),a+(e-n)},dissolveList:function(e){function t(e){return 50<=e?"l"+t(e-50):40<=e?"xl"+t(e-40):10<=e?"x"+t(e-10):9==e?"ix":5<=e?"v"+t(e-5):4==e?"iv":1<=e?"i"+t(e-1):""}var n,o=[],r=[];for(e.forEach(function(e){if("li"==e.name){var n=e.children[0];if(n&&n.name&&n.attributes.style&&n.attributes.style.match(/mso-list:/i)){i.pushStylesLower(e,{"list-style-type":!0,display:!0});var s=a.parseCssText(n.attributes.style,!0);i.setStyle(e,"mso-list",s["mso-list"],!0),i.setStyle(n,"mso-list",""),(s.display||s.DISPLAY)&&(s.display?i.setStyle(e,"display",s.display,!0):i.setStyle(e,"display",s.DISPLAY,!0))}e.attributes.style&&e.attributes.style.match(/mso-list:/i)&&(e.name="p",e.attributes["cke-dissolved"]=!0,o.push(e))}if("ul"==e.name||"ol"==e.name){for(n=0;n<e.children.length;n++)if("li"==e.children[n].name){var s=e.attributes.type,l=parseInt(e.attributes.start,10)||1;switch(s||(s=a.parseCssText(e.attributes.style)["list-style-type"]),s){case"disc":s="\xb7";break;case"circle":s="o";break;case"square":s="\xa7";break;case"1":case"decimal":s=l+n+".";break;case"a":case"lower-alpha":s=String.fromCharCode(97+l-1+n)+".";break;case"A":case"upper-alpha":s=String.fromCharCode(65+l-1+n)+".";break;case"i":case"lower-roman":s=t(l+n)+".";break;case"I":case"upper-roman":s=t(l+n).toUpperCase()+".";break;default:s="ul"==e.name?"\xb7":l+n+"."}e.children[n].attributes["cke-symbol"]=s}r.push(e)}},CKEDITOR.NODE_ELEMENT,!1),n=o.length-1;0<=n;n--)o[n].insertAfter(e);for(n=r.length-1;0<=n;n--)delete r[n].name},groupLists:function(e){var t,i,o=[[e[0]]],a=o[0];for(i=e[0],i.attributes["cke-indentation"]=i.attributes["cke-indentation"]||n.getElementIndentation(i),t=1;t<e.length;t++){i=e[t];var r=e[t-1];i.attributes["cke-indentation"]=i.attributes["cke-indentation"]||n.getElementIndentation(i),i.previous!==r&&(n.chopDiscontinuousLists(a,o),o.push(a=[])),a.push(i)}return n.chopDiscontinuousLists(a,o),o},chopDiscontinuousLists:function(e,t){for(var i,o={},r=[[]],s=0;s<e.length;s++){var l,c,d=o[e[s].attributes["cke-list-level"]],u=this.getListItemInfo(e[s]);for(d?(c=d.type.match(/alpha/)&&7==d.index?"alpha":c,c="o"==e[s].attributes["cke-symbol"]&&14==d.index?"alpha":c,l=n.getSymbolInfo(e[s].attributes["cke-symbol"],c),u=this.getListItemInfo(e[s]),(d.type!=l.type||i&&u.id!=i.id&&!this.isAListContinuation(e[s]))&&r.push([])):l=n.getSymbolInfo(e[s].attributes["cke-symbol"]),i=parseInt(e[s].attributes["cke-list-level"],10)+1;20>i;i++)o[i]&&delete o[i];o[e[s].attributes["cke-list-level"]]=l,r[r.length-1].push(e[s]),i=u}[].splice.apply(t,[].concat([a.indexOf(t,e),1],r))},isAListContinuation:function(e){var t=e;do if((t=t.previous)&&t.type===CKEDITOR.NODE_ELEMENT){if(void 0===t.attributes["cke-list-level"])break;if(t.attributes["cke-list-level"]===e.attributes["cke-list-level"])return t.attributes["cke-list-id"]===e.attributes["cke-list-id"]}while(t);return!1},getElementIndentation:function(e){if(e=a.parseCssText(e.attributes.style),e.margin||e.MARGIN){e.margin=e.margin||e.MARGIN;var t={styles:{margin:e.margin}};CKEDITOR.filter.transformationsTools.splitMarginShorthand(t),e["margin-left"]=t.styles["margin-left"]}return parseInt(a.convertToPx(e["margin-left"]||"0px"),10)},toArabic:function(e){return e.match(/[ivxl]/i)?e.match(/^l/i)?50+n.toArabic(e.slice(1)):e.match(/^lx/i)?40+n.toArabic(e.slice(1)):e.match(/^x/i)?10+n.toArabic(e.slice(1)):e.match(/^ix/i)?9+n.toArabic(e.slice(2)):e.match(/^v/i)?5+n.toArabic(e.slice(1)):e.match(/^iv/i)?4+n.toArabic(e.slice(2)):e.match(/^i/i)?1+n.toArabic(e.slice(1)):n.toArabic(e.slice(1)):0},getSymbolInfo:function(e,t){var i=e.toUpperCase()==e?"upper-":"lower-",o={"\xb7":["disc",-1],o:["circle",-2],"\xa7":["square",-3]};return e in o||t&&t.match(/(disc|circle|square)/)?{index:o[e][1],type:o[e][0]}:e.match(/\d/)?{index:e?parseInt(n.getSubsectionSymbol(e),10):0,type:"decimal"}:(e=e.replace(/\W/g,"").toLowerCase(),!t&&e.match(/[ivxl]+/i)||t&&"alpha"!=t||"roman"==t?{index:n.toArabic(e),type:i+"roman"}:e.match(/[a-z]/i)?{index:e.charCodeAt(0)-97,type:i+"alpha"}:{index:-1,type:"disc"})},getListItemInfo:function(e){if(void 0!==e.attributes["cke-list-id"])return{id:e.attributes["cke-list-id"],level:e.attributes["cke-list-level"]};var t=a.parseCssText(e.attributes.style)["mso-list"],n={id:"0",level:"1"};return t&&(t+=" ",n.level=t.match(/level(.+?)\s+/)[1],n.id=t.match(/l(\d+?)\s+/)[1]),e.attributes["cke-list-level"]=void 0!==e.attributes["cke-list-level"]?e.attributes["cke-list-level"]:n.level,e.attributes["cke-list-id"]=n.id,n}},n=CKEDITOR.plugins.pastefromword.lists,n.setListSymbol.removeRedundancies=function(e,t){(1===t&&"disc"===e["list-style-type"]||"decimal"===e["list-style-type"])&&delete e["list-style-type"]},CKEDITOR.plugins.pastefromword.createAttributeStack=t}();